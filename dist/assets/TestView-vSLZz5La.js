import{_ as I,c as a,o as l,a as s,r as A,d as B,u as N,b as V,e as p,f as F,g as D,h as E,n as P,t as d,i as h,F as R,j as z,w as _,S as k,k as o,l as $,m as M,p as O}from"./index-B7-GSVGD.js";const Q={};function j(b,r){return l(),a("button",null,[r[0]||(r[0]=s("div",{class:"ball"},null,-1)),s("p",null,[A(b.$slots,"default",{},void 0)])])}const L=I(Q,[["render",j],["__scopeId","data-v-edaf88b7"]]),U={key:0},G={class:"title"},H={class:"question-container"},J={class:"question-actions"},K={class:"question-actions__buttons"},W={class:"dialog-content"},X={key:0},Y={key:1},Z={class:"dialog-actions"},ee={key:1},se={key:0},te={key:1},le=B({__name:"TestView",setup(b){var C;const r=N("finishInfo"),q=F(),m=E(),v=V();let g=0;const y=p(!1),c=((C=q.params.id)==null?void 0:C.toString())??"",t=p({pages:666,currPage:0,question:"",answers:[]}),u=p({finished:!1,level:null,correctCnt:0,correctPct:0}),i=p(-1),x=async()=>{const w=i.value;i.value=-2;let e={};c!=="demo"?e=await v.sendTestAnswer(t.value.currPage,w):(e=await v.loadDemoTestQuestion(t.value.currPage),w===v.demoTestCorrectAnswers[t.value.currPage-1]&&(g+=1)),e!=null&&e.finished?(u.value=e,u.value.correctCnt=g,u.value.correctPct=g/t.value.pages*100,r.value.showModal()):(t.value=e,i.value=-1)};return D(async()=>{if(!c)m.push({name:"home",query:{err:"TEST_NOT_FOUND"}});else if(c!=="demo")try{t.value=await v.startTest(c)}catch{y.value=!0}else t.value=await v.loadDemoTestQuestion(0)}),(w,e)=>{var T,S;return t.value.currPage>0?(l(),a("main",U,[s("header",null,[s("div",{class:"header-progress",style:P({width:`${t.value.currPage/t.value.pages*100}%`})},null,4),s("span",G,[s("h2",null,d(t.value.currPage)+" / "+d(t.value.pages),1)]),e[3]||(e[3]=s("p",null,"Из предложенных внизу вариантов выберите верное пропущенное в предложении слово.",-1))]),s("div",H,[s("h1",null,d(t.value.question),1)]),s("div",J,[s("div",K,[(l(!0),a(R,null,z(t.value.answers,(f,n)=>(l(),M(L,{disabled:i.value<-1,class:O(["round",{selected:i.value===n}]),value:"i",onClick:ne=>i.value=n},{default:_(()=>[o(d(f),1)]),_:2},1032,["disabled","class","onClick"]))),256))]),h(k,{disabled:i.value<0,onClick:e[0]||(e[0]=f=>x())},{default:_(()=>e[4]||(e[4]=[o(" Далее » ")])),_:1,__:[4]},8,["disabled"])]),s("div",{class:"finish-animation",style:P({height:`${(T=u.value)==null?void 0:T.correctPct}%`||0})},null,4),s("dialog",{class:"finishInfo",ref_key:"finishInfo",ref:r},[s("section",W,[e[9]||(e[9]=s("h2",null,"Тест завершён",-1)),s("div",null,[(S=u.value)!=null&&S.level?(l(),a("h3",X,[e[5]||(e[5]=o(" Предположительный уровень ")),e[6]||(e[6]=s("br",null,null,-1)),e[7]||(e[7]=o("владения языком: ")),s("b",null,d(u.value.level),1)])):(l(),a("h3",Y," Поздравляем с прохождением вашего первого теста — вы сделали маленький, но важный шаг в сторону улучшения ваших навыков! ")),e[8]||(e[8]=s("hr",null,null,-1)),o(" Вы верно ответили на "+d(u.value.correctCnt)+" вопросов из "+d(t.value.pages)+". ",1)])]),s("section",Z,[h(k,{onClick:e[1]||(e[1]=f=>{var n;$(m).push("/home"),(n=r.value)==null||n.close()})},{default:_(()=>e[10]||(e[10]=[o(" В главное меню ")])),_:1,__:[10]})])],512)])):(l(),a("main",ee,[y.value?(l(),a("span",te,e[12]||(e[12]=[s("h1",null,"❌ Не удалось загрузить тест!",-1),s("p",null,[o(" Возможно, у вас пропал интернет или сервер бэкенда сейчас недоступен. Повторите попытку позже, а сейчас вы можете вернуться на главную или попробовать перепройти демо-тест: "),s("br"),s("br"),s("br")],-1)]))):(l(),a("span",se,e[11]||(e[11]=[s("h1",null,"⌛ Загрузка теста…",-1)]))),h(k,{onClick:e[2]||(e[2]=f=>{var n;$(m).push("/home"),(n=r.value)==null||n.close()})},{default:_(()=>e[13]||(e[13]=[o(" В главное меню ")])),_:1,__:[13]})]))}}}),ae=I(le,[["__scopeId","data-v-eee3dadf"]]);export{ae as default};
